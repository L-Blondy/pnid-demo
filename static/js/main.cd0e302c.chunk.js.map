{"version":3,"sources":["hooks/createGlobalListener.tsx","hooks/useIsValidClickRef.tsx","hooks/index.ts","components/BoundingBox.tsx","assets/page1.jpg","assets/page2.jpg","assets/page3.jpg","components/Page.tsx","App.tsx","components/Router.tsx","reportWebVitals.ts","index.tsx"],"names":["createGlobalListener","eventType","callbacks","nextID","document","addEventListener","e","Object","values","forEach","cb","passive","callback","id","useMemo","useEffect","useIsValidClickRef","isValidClickRef","useRef","isMouseDownRef","useGlobalMouseDown","current","useGlobalMouseMove","useGlobalMouseUp","setTimeout","BoundingBox","x","y","width","height","to","resetTransform","highlightCount","fileName","useParams","useState","isValidClick","setIsValidClick","isFirstRenderRef","linkRef","divRef","style","top","left","pointerEvents","classList","contains","remove","add","ref","className","onMouseDown","fileName1","srcPage1","split","pop","fileName2","srcPage2","fileName3","srcPage3","Page","img","setImg","boxBounds","_img","createElement","src","onload","onerror","console","log","wheel","step","options","limitToBounds","minScale","maxScale","doubleClick","disabled","reset","animation","animationTime","image","undefined","App","setHighlightCount","onClick","c","Router","basename","viewBox","fill","xmlns","rx","d","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.cd0e302c.chunk.js","sourcesContent":["import { useEffect, useMemo } from 'react'\n\nfunction createGlobalListener<T extends keyof DocumentEventMap>(eventType: T) {\n\n\tconst callbacks: { [ key: number ]: (e: DocumentEventMap[ T ]) => void } = {}\n\tlet nextID: number = 0\n\n\tdocument.addEventListener(eventType, (e: DocumentEventMap[ T ]) => {\n\t\tObject.values(callbacks).forEach(cb => {\n\t\t\tcb(e)\n\t\t})\n\t}, { passive: false })\n\n\treturn function (callback: (e: DocumentEventMap[ T ]) => void) {\n\n\t\tconst id = useMemo(() => (nextID++), [])\n\n\t\tuseEffect(() => {\n\t\t\tcallbacks[ id ] = callback\n\t\t\treturn () => { delete callbacks[ id ] }\n\t\t}, [ callback, id ])\n\t}\n}\n\nexport default createGlobalListener","import { useRef } from 'react'\nimport { useGlobalMouseUp, useGlobalMouseMove, useGlobalMouseDown } from 'src/hooks'\n\nconst useIsValidClickRef = () => {\n\n\tconst isValidClickRef = useRef(true)\n\tconst isMouseDownRef = useRef(false)\n\n\tuseGlobalMouseDown(() => {\n\t\tisMouseDownRef.current = true\n\t})\n\n\tuseGlobalMouseMove(() => {\n\t\tif (!isMouseDownRef.current) return\n\t\tisValidClickRef.current = false\n\t})\n\n\tuseGlobalMouseUp(() => {\n\t\tsetTimeout(() => {\n\t\t\tisValidClickRef.current = true\n\t\t})\n\t\tisMouseDownRef.current = false\n\t})\n\n\treturn isValidClickRef\n}\n\nexport default useIsValidClickRef","import createGlobalListener from './createGlobalListener'\r\nexport const useGlobalClick = createGlobalListener('click')\r\nexport const useGlobalKeyDown = createGlobalListener('keydown')\r\nexport const useGlobalKeyUp = createGlobalListener('keyup')\r\nexport const useGlobalMouseDown = createGlobalListener('mousedown')\r\nexport const useGlobalMouseMove = createGlobalListener('mousemove')\r\nexport const useGlobalMouseUp = createGlobalListener('mouseup')\r\nexport const useGlobalWheel = createGlobalListener('wheel')\r\nexport { default as useKeyBinding } from './useKeyBinding'\r\nexport { default as useIsValidClickRef } from './useIsValidClickRef'","import { useEffect, useRef, useState } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { useGlobalMouseUp, useGlobalMouseMove } from 'src/hooks'\n\n\ninterface Props {\n\tx: string,\n\ty: string,\n\twidth: string,\n\theight: string,\n\tto: string,\n\tresetTransform: () => void\n\thighlightCount: number\n}\n\nconst BoundingBox = ({\n\tx,\n\ty,\n\twidth,\n\theight,\n\tto,\n\tresetTransform,\n\thighlightCount\n\n}: Props) => {\n\n\tconst { fileName } = useParams<{ fileName: string }>()\n\tconst isMouseDownRef = useRef(false)\n\tconst [ isValidClick, setIsValidClick ] = useState(true)\n\tconst isFirstRenderRef = useRef(true)\n\tconst linkRef = useRef<HTMLAnchorElement | null>(null)\n\tconst divRef = useRef<HTMLDivElement | null>(null)\n\n\tconst style = {\n\t\ttop: y,\n\t\tleft: x,\n\t\twidth,\n\t\theight,\n\t\tpointerEvents: isValidClick ? 'auto' : 'none' as 'auto' | 'none'\n\t}\n\tuseEffect(() => resetTransform(), [ to ])\n\n\tuseEffect(() => {\n\t\tif (!isFirstRenderRef.current) {\n\n\t\t\tlinkRef.current?.classList.contains('highlight') && linkRef.current?.classList.remove('highlight')\n\t\t\tsetTimeout(() => linkRef.current?.classList.add('highlight'), 17)\n\t\t\tdivRef.current?.classList.contains('highlight') && divRef.current?.classList.remove('highlight')\n\t\t\tsetTimeout(() => divRef.current?.classList.add('highlight'), 17)\n\t\t}\n\t\tisFirstRenderRef.current = false\n\t}, [ highlightCount ])\n\n\tfunction handleMouseDown() {\n\t\tisMouseDownRef.current = true\n\t}\n\n\tuseGlobalMouseMove(() => {\n\t\tisMouseDownRef.current && setIsValidClick(false)\n\t\tsetTimeout(() => setIsValidClick(true), 3000)\n\t})\n\n\tuseGlobalMouseUp(() => {\n\t\tsetIsValidClick(true)\n\t\tisMouseDownRef.current = false\n\t})\n\n\treturn to === fileName\n\t\t? (\n\t\t\t<div\n\t\t\t\tref={divRef}\n\t\t\t\tclassName='bounding_box'\n\t\t\t\tstyle={style}>\n\t\t\t\tImagine it's a Bounding box\n\t\t\t</div>\n\t\t)\n\t\t: (\n\t\t\t<Link\n\t\t\t\tref={linkRef}\n\t\t\t\tonMouseDown={handleMouseDown}\n\t\t\t\tclassName='bounding_box'\n\t\t\t\tstyle={style}\n\t\t\t\tto={to}>\n\t\t\t\tImagine it's a Bounding box\n\t\t\t</ Link>\n\t\t)\n\n}\n\nexport default BoundingBox;","export default __webpack_public_path__ + \"static/media/page1.e676e72f.jpg\";","export default __webpack_public_path__ + \"static/media/page2.3920478d.jpg\";","export default __webpack_public_path__ + \"static/media/page3.2944ec68.jpg\";","import { TransformWrapper, TransformComponent } from \"react-zoom-pan-pinch\";\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useParams } from 'react-router-dom'\nimport { Stage, Layer, Image } from 'react-konva'\nimport BoundingBox from './BoundingBox'\n\nimport srcPage1 from 'src/assets/page1.jpg'\nimport srcPage2 from 'src/assets/page2.jpg'\nimport srcPage3 from 'src/assets/page3.jpg'\n\nconst fileName1 = srcPage1.split('/').pop() as string\nconst fileName2 = srcPage2.split('/').pop() as string\nconst fileName3 = srcPage3.split('/').pop() as string\n\ninterface Props {\n\thighlightCount: number\n}\n\nfunction Page({\n\thighlightCount\n}: Props) {\n\n\tconst { fileName } = useParams<{ fileName: string }>()\n\tconst [ img, setImg ] = useState<HTMLImageElement | null>(null)\n\n\tconst boxBounds = useMemo(() => {\n\t\tif (fileName === fileName1) {\n\t\t\treturn {\n\t\t\t\tx: '30%',\n\t\t\t\ty: '10%',\n\t\t\t\twidth: '10%',\n\t\t\t\theight: '10%'\n\t\t\t}\n\t\t}\n\t\tif (fileName === fileName2) {\n\t\t\treturn {\n\t\t\t\tx: '20%',\n\t\t\t\ty: '50%',\n\t\t\t\twidth: '10%',\n\t\t\t\theight: '10%'\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn {\n\t\t\t\tx: '70%',\n\t\t\t\ty: '40%',\n\t\t\t\twidth: '10%',\n\t\t\t\theight: '10%'\n\t\t\t}\n\t\t}\n\t}, [ fileName ])\n\n\tuseEffect(() => {\n\t\tsetImg(null)\n\n\t\tlet _img: HTMLImageElement\n\t\t_img = document.createElement('img')\n\t\t_img.src = '/pnid-demo/static/media/' + fileName\n\t\t_img.onload = () => setImg(_img)\n\t\t_img.onerror = console.log\n\t}, [ fileName ])\n\n\treturn (\n\n\t\t<TransformWrapper\n\t\t\twheel={{ step: 200, }}\n\t\t\toptions={{ limitToBounds: false, minScale: 0.5, maxScale: 10 }}\n\t\t\tdoubleClick={{ disabled: true }}\n\t\t\treset={{ animation: false, animationTime: 0 }}>\n\n\t\t\t{({ resetTransform }: { resetTransform: () => void }) => (\n\n\t\t\t\t<TransformComponent>\n\t\t\t\t\t<div className='image-wrapper'>\n\t\t\t\t\t\t<Stage\n\t\t\t\t\t\t\tclassName={`image ${!!img ? 'loaded' : 'pending'}`}\n\t\t\t\t\t\t\twidth={3308}\n\t\t\t\t\t\t\theight={2339}>\n\n\t\t\t\t\t\t\t<Layer>\n\t\t\t\t\t\t\t\t<Image image={img || undefined} />\n\t\t\t\t\t\t\t</Layer>\n\n\t\t\t\t\t\t</Stage>\n\n\t\t\t\t\t\t{!!img && (\n\t\t\t\t\t\t\t<BoundingBox\n\t\t\t\t\t\t\t\tx={boxBounds.x}\n\t\t\t\t\t\t\t\ty={boxBounds.y}\n\t\t\t\t\t\t\t\twidth={boxBounds.width}\n\t\t\t\t\t\t\t\theight={boxBounds.height}\n\t\t\t\t\t\t\t\tto={fileName === fileName1 ? fileName2 : fileName3}\n\t\t\t\t\t\t\t\tresetTransform={resetTransform}\n\t\t\t\t\t\t\t\thighlightCount={highlightCount}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t</div>\n\t\t\t\t</TransformComponent>\n\t\t\t)}\n\n\t\t</TransformWrapper >\n\t)\n}\n\nexport default Page;","import './App.scss'\nimport Page from 'src/components/Page'\nimport { useState } from 'react'\nimport { useIsValidClickRef } from 'src/hooks'\n\nconst App = () => {\n\n\tconst isValidClickRef = useIsValidClickRef()\n\tconst [ highlightCount, setHighlightCount ] = useState(0)\n\n\tfunction handleClick() {\n\t\tisValidClickRef.current && setHighlightCount(c => ++c)\n\t}\n\n\treturn (\n\t\t<div className='app' onClick={handleClick} >\n\t\t\t<Page highlightCount={highlightCount} />\n\t\t</div>\n\t)\n}\n\nexport default App","import { BrowserRouter, Switch, Route, Redirect, useLocation } from 'react-router-dom'\nimport App from 'src/App'\nimport { useEffect, useState } from 'react'\n\nimport srcPage1 from 'src/assets/page1.jpg'\nconst fileName1: string = srcPage1.split('/').pop() as string\n\nconst Router: React.FC = () => {\n\n\treturn (\n\t\t<BrowserRouter basename='/pnid-demo/'>\n\t\t\t<div className='help'>\n\t\t\t\t<button>\n\t\t\t\t\t<svg width=\"512\" height=\"512\" viewBox=\"0 0 512 512\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<rect width=\"512\" height=\"512\" rx=\"256\" fill=\"white\" />\n\t\t\t\t\t\t<path d=\"M256 0C114.833 0 0 114.833 0 256C0 397.167 114.833 512 256 512C397.167 512 512 397.167 512 256C512 114.833 397.167 0 256 0ZM245.333 426.667C227.687 426.667 213.333 412.313 213.333 394.667C213.333 377.021 227.687 362.667 245.333 362.667C262.979 362.667 277.333 377.021 277.333 394.667C277.333 412.313 262.979 426.667 245.333 426.667ZM277.333 296.542V330.667C277.333 336.563 272.562 341.334 266.666 341.334H224C218.104 341.334 213.333 336.563 213.333 330.667V277.334C213.333 253.813 232.479 234.667 256 234.667C279.521 234.667 298.667 215.521 298.667 192C298.667 168.479 279.521 149.333 256 149.333C232.479 149.333 213.333 168.479 213.333 192V202.667C213.333 208.563 208.562 213.334 202.666 213.334H160C154.104 213.334 149.333 208.563 149.333 202.667V192C149.333 133.187 197.187 85.333 256 85.333C314.813 85.333 362.667 133.188 362.667 192C362.667 243.188 326.604 286.563 277.333 296.542Z\" fill=\"#00A1E7\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\n\t\t\t\t<ul className=\"content\">\n\t\t\t\t\t<li> Use mouse wheel to <b>zoom</b>. </li>\n\t\t\t\t\t<li> Click and drag to <b>move</b>. </li>\n\t\t\t\t\t<li> Click anywhere to <b>show hotspots</b>. </li>\n\t\t\t\t\t<li> Click a part to display the related <b>P&ID</b>. </li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<Switch>\n\t\t\t\t<Route path='/pnid/:fileName'>\n\t\t\t\t\t<App />\n\t\t\t\t</Route>\n\t\t\t\t<Redirect to={`/pnid/${fileName1}`} />\n\t\t\t</Switch>\n\t\t</BrowserRouter>\n\t)\n}\n\nexport default Router","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Router from 'src/components/Router';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}